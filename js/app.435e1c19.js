(function(t){function a(a){for(var n,i,o=a[0],l=a[1],c=a[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&p.push(s[i][0]),s[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(a);while(p.length)p.shift()();return r.push.apply(r,c||[]),e()}function e(){for(var t,a=0;a<r.length;a++){for(var e=r[a],n=!0,o=1;o<e.length;o++){var l=e[o];0!==s[l]&&(n=!1)}n&&(r.splice(a--,1),t=i(i.s=e[0]))}return t}var n={},s={app:0},r=[];function i(a){if(n[a])return n[a].exports;var e=n[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=n,i.d=function(t,a,e){i.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,a){if(1&a&&(t=i(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)i.d(e,n,function(a){return t[a]}.bind(null,n));return e},i.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(a,"a",a),a},i.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=a,o=o.slice();for(var c=0;c<o.length;c++)a(o[c]);var u=l;r.push([1,"chunk-vendors"]),e()})({0:function(t,a){},"034f":function(t,a,e){"use strict";var n=e("64a9"),s=e.n(n);s.a},"042d":function(t,a,e){"use strict";var n=e("0efc"),s=e.n(n);s.a},"0c20":function(t,a,e){t.exports=e.p+"img/fantasy_map_1554102582670.ff8ad0fd.png"},"0efc":function(t,a,e){},1:function(t,a,e){t.exports=e("56d7")},10:function(t,a){},11:function(t,a){},12:function(t,a){},1574:function(t,a,e){"use strict";var n=e("cb87"),s=e.n(n);s.a},2:function(t,a){},3:function(t,a){},4:function(t,a){},"49c0":function(t,a,e){"use strict";var n=e("acec"),s=e.n(n);s.a},5:function(t,a){},5490:function(t,a,e){"use strict";var n=e("bdf3"),s=e.n(n);s.a},"56d7":function(t,a,e){"use strict";e.r(a);e("ac6a"),e("cadf"),e("551c"),e("f751"),e("097d");var n=e("a026"),s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[e("site-navbar"),e("router-view")],1)},r=[],i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("nav",{staticClass:"navbar navbar-expand-sm navbar-dark bg-dark"},[t._m(0),e("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarTogglerDemo01"}},[e("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v("â—Ž")]),t._m(1),e("ul",{staticClass:"navbar-nav ml-auto mt-2 mt-lg-0"},[e("li",{staticClass:"nav-item"},[e("router-link",{attrs:{to:"/profile"}},[e("img",{staticStyle:{width:"23px",margin:"-10"},attrs:{src:t.avatar,alt:"Profile image"}})])],1)])],1)])},o=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarTogglerDemo01","aria-controls":"navbarTogglerDemo01","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",{staticClass:"navbar-nav mr-auto mt-2 mt-lg-0"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#"}})])])}],l=(e("b54a"),e("7f7f"),e("3e1e")),c=e.n(l);c.a.paraMap=e("a7b3");var u=e("8654"),d=u.isBlob,p=e("50ce").create;var m={loadMessage:function(t,a,e){},post_as:function(t,a,e,n){t.getLatest(a.id,function(s,r){var i=r?{id:r.key,sequence:r.value.sequence,timestamp:r.value.timestamp,queue:[]}:{id:null,sequence:null,timestamp:null,queue:[]};t.add(p(i,a,null,e,Date.now()),function(t,a){if(t)throw t;n&&n()})})},related:function(t,a,e){c()(t.backlinks.read({live:!0,query:[{$filter:{dest:a,value:{content:{type:"post"}}}}]}),c.a.filter(function(t){return!t.sync}),c.a.drain(function(t){e(null,t)}))},countStream:function(t,a,e){c()(t.backlinks.read({live:!0,query:[{$filter:{dest:a,value:{content:{type:"vote",vote:{link:a}}}}}]}),c.a.filter(function(t){return!t.sync}),c.a.drain(function(t){e(null,t)}))},displayName:function(t,a,e){var n={},s={limit:1,reverse:!0,query:[{$filter:{value:{author:a,content:{type:"about",about:a,name:{$is:"string"}}},timestamp:{$gt:0}}},{$map:{name:["value","content","name"]}}]};c()(t.query.read(s),c.a.collect(function(t,s){var r;t?e(t):(r=s&&s.length?s[0].name:a,n.authorName=r,e(null,n))}))},avatar:function(t,a,e){var n={reverse:!0,query:[{$filter:{value:{author:a,content:{type:"about",about:a,image:{$truthy:!0}},timestamp:{$gt:0}}}},{$map:{image:["value","content","image"]}}]};c()(t.query.read(n),c.a.map(function(t){return"string"===typeof t.image?t.image:t.image.link}),c.a.filter(function(t){return d(t)}),c.a.take(1),c.a.collect(function(t,a){t?e(t):a&&a.length?e(null,a[0]):e(null,null)}))}},f=e("91d2"),h=e.n(f),v={name:"site-navbar",data:function(){return{avatar:"https://via.placeholder.com/90x90",author:"..."}},mounted:function(){var t=this;this.$ssb.then(function(a){m.displayName(a,JSON.parse(localStorage.keys).id,t.name_loaded),m.avatar(a,JSON.parse(localStorage.keys).id,t.avatar_loaded)})},methods:{name_loaded:function(t,a){if(this.$data.author=a,"https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,JSON.parse(localStorage.keys).id).getImage();this.$data.avatar=e}},avatar_loaded:function(t,a){a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)}}},g=v,b=e("2877"),y=Object(b["a"])(g,i,o,!1,null,"6fa9493a",null),_=y.exports,x={name:"app",components:{"site-navbar":_}},$=x,w=(e("034f"),Object(b["a"])($,s,r,!1,null,null,null)),S=w.exports,C=e("8c4f"),k=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"fluid-container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6",attrs:{id:"map"}},[e("MapSVG",{attrs:{id:"map_svg"}})],1),e("div",{staticClass:"col-md-6",attrs:{id:""}},[e("div",{staticClass:"card-body scroll",staticStyle:{"max-height":"1500px"}},[e("TileInfo",{attrs:{x:t.x,y:t.y,active_tags:t.active_tags}}),e("Messages",{staticStyle:{"max-height":"100%"},attrs:{this_tile_tags:t.active_tags,x:t.x,y:t.y},on:{new_post:t.handle_new_post}})],1)])])])},O=[],j=(e("6c7b"),{functional:!0,render(t,a){const{_c:e,_v:n,data:s,children:r=[]}=a,{class:i,staticClass:o,style:l,staticStyle:c,attrs:u={},...d}=s;return e("svg",{class:[i,o],style:[l,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1462",height:"1949"},u),...d},r)}}),N=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row"},[e("Composer",{attrs:{active_tags:t.this_tile_tags,x:t.$props.x,y:t.$props.y},on:{new_post:t.new_post}}),t.loading?e("div",{staticClass:"spinner-border",attrs:{label:"Spinning"}}):t._e(),t._l(t.messages,function(a){return e("Message",{key:a.key,attrs:{message:a,x:t.$props.x,y:t.$props.y}})})],2)},P=[],M=(e("8e6e"),e("456d"),e("bd86")),E=(e("55dd"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"media mt-3 col-sm-12 message"},[e("router-link",{attrs:{to:{name:"ViewProfile",params:{id:t.message.value.author}}}},[e("img",{staticClass:"pr-3 rounded ",staticStyle:{"max-width":"60px"},attrs:{src:t.avatar}})]),e("div",{staticClass:"media-body"},[e("h5",{staticClass:"mt-0 text-truncate"},[e("router-link",{staticClass:"text-dark font-weight-bold",attrs:{to:{name:"ViewProfile",params:{id:t.message.value.author}}}},[t._v("\n          "+t._s(t.author.authorName)+"  \n        ")]),e("span",{staticClass:"text-muted"},[t._l(t.message.value.content.tags,function(a){return e("span",[t._v("\n            "+t._s(a)+"\n          ")])}),t.message.value.content.x&&t.message.value.content.y?e("span",[t._v("\n            "+t._s(t.message.value.content.x)+"/"+t._s(t.message.value.content.y)+"\n          ")]):t._e(),t.message.value.content.channel?e("span",{staticClass:"text-dark"},[t._v("#"+t._s(t.message.value.content.channel))]):t._e()],2)],1),e("div",{staticClass:"tweet-text"},[e("read-more",{attrs:{"more-str":"[more]","less-str":"[less]","max-chars":400,text:t.textmd}})],1),e("div",{staticClass:"tweet-footer"},[e("a",{staticClass:"tweet-footer-btn",on:{click:t.likeClick}},[e("eva-icon",{attrs:{name:"heart-outline",animation:"pulse"}}),e("span",[t._v(t._s(t.likes.length))])],1)]),e("div",{staticClass:"float-right text-muted small"},[t.message.value.timestamp?e("timeago",{attrs:{datetime:t.message.value.timestamp,"auto-update":60}}):t._e()],1)])],1)}),J=[];c.a.paraMap=e("a7b3");var I=e("90ce"),U={name:"message",props:{message:{},x:String,y:String,active_tags:Array},data:function(){return{avatar:"https://via.placeholder.com/90x90",author:"...",textmd:"...",likes:[],related:[],replies:0}},methods:{name_loaded:function(t,a){if(this.$data.author=a,"https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,this.message.value.author).getImage();this.$data.avatar=e}},related_loaded:function(t,a){this.$data.related.push(a)},avatar_loaded:function(t,a){a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)},like_loaded:function(t,a){this.$data.likes.push(a)},previous_loaded:function(t,a){this.$data.previous=a},likeClick:function(){var t=this;this.$ssb.then(function(a){var e=parseInt(t.$props.x),n=parseInt(t.$props.y),s={type:"vote",x:e,y:n,channel:t.message.value.content.channel,tags:t.message.value.content.tags,vote:{value:1,link:t.message.key}};m.post_as(a,JSON.parse(localStorage.keys),s)})}},mounted:function(){var t=this;this.$data.textmd=I.block(this.message.value.content.text,{toUrl:function(t){return"http://ssb.guild.land/blobs/get/"+t}}),this.$ssb.then(function(a){m.displayName(a,t.message.value.author,t.name_loaded),m.avatar(a,t.message.value.author,t.avatar_loaded),m.countStream(a,t.message.key,t.like_loaded)})}},z=U,T=(e("042d"),Object(b["a"])(z,E,J,!1,null,"a6ca914c",null)),q=T.exports,D=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-group media mt-2 col-sm-12 message"},[e("router-link",{attrs:{to:{name:"Profile"}}},[e("img",{staticClass:"pr-3 rounded ",staticStyle:{"max-width":"60px"},attrs:{src:t.avatar}})]),e("form",{on:{submit:function(a){return a.preventDefault(),t.post(a)}}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control",attrs:{autofocus:"",placeholder:"New message at this location"},domProps:{value:t.message},on:{input:[function(a){a.target.composing||(t.message=a.target.value)},function(a){t.writing=!0}],click:function(a){t.writing=!0},blur:function(a){0==t.message.length&&(t.writing=!1)}}}),t.writing?e("vue-tags-input",{attrs:{tags:t.tags},on:{"tags-changed":function(a){return t.tags=a}},model:{value:t.tag,callback:function(a){t.tag=a},expression:"tag"}}):t._e(),t.writing?e("button",{staticClass:"btn btn-outline-primary",attrs:{type:"submit"}},[t._v("Post")]):t._e()],1)],1)},A=[],L=e("c7a0"),H={name:"composer",props:{x:String,y:String,active_tags:Array},components:{VueTagsInput:L["VueTagsInput"]},data:function(){return{avatar:"https://via.placeholder.com/90x90",message:"",writing:!1,tag:"",tags:[]}},watch:{active_tags:function(t,a){this.$data.tags=Object(L["createTags"])(t)}},mounted:function(){var t=this;this.$ssb.then(function(a){m.avatar(a,JSON.parse(localStorage.keys).id,t.avatar_loaded)})},methods:{avatar_loaded:function(t,a){if("https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,JSON.parse(localStorage.keys).id).getImage();this.$data.avatar=e}a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)},post:function(t){var a=this;if(this.$data.message){var e=parseInt(this.$props.x),n=parseInt(this.$props.y);this.$ssb.then(function(t){var s={type:"post",text:a.$data.message,x:e,y:n};a.$data.tags.length>0&&(s.tags=a.$data.tags.map(function(t){return t.text})),m.post_as(t,JSON.parse(localStorage.keys),s),a.$emit("new_post"),a.$data.message=""})}}}},V=H,F=Object(b["a"])(V,D,A,!1,null,"5cb58862",null),G=F.exports;function R(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function B(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?R(e,!0).forEach(function(a){Object(M["a"])(t,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):R(e).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})}return t}var K,Q=e("3e1e"),X=(e("90de"),e("8c62")),Y=2;function W(t,a){var e=t.value.timestamp,n=a.value.timestamp;return e<n?1:e>n?-1:0}var Z={name:"Messages",components:{Message:q,Composer:G},data:function(){return{ssb:"",messages:[],identity:"...",loading:!0}},props:{msg:String,x:String,y:String,this_tile_tags:Array},computed:{position:function(){return this.x,this.y}},methods:{new_post:function(){this.$emit("new_post")},message_arrived:function(t){t.sync?this.$data.loading=!1:(this.$data.messages.push(t),this.$data.messages.sort(W))},name_loaded:function(t,a){this.$data.identity=a.authorName},fetch_messages:function(){var t=this;this.$data.messages=[],this.$data.loading=!0,this.$ssb.then(function(a){t.$data.ssb=a,m.displayName(a,JSON.parse(localStorage.keys).id,t.name_loaded);var e,n=parseInt(t.$props.x),s=parseInt(t.$props.y),r=!1;if(4==n&&21==s&&(r=!0),r)t.$data.loading=!1,e={limit:20,reverse:!0,live:!0,query:[{$filter:{value:{content:{type:"post"}}}}]};else if(e={limit:50,reverse:!0,live:!0,query:[{$filter:{value:{content:{type:"post",x:{$gt:0},y:{$gt:0}}}}}]},!isNaN(n)&&!isNaN(s)){var i=e.query[0].$filter.value.content;i.x=B({},i.x,{},{$gt:n-Y,$lt:n+Y}),i.y=B({},i.y,{},{$gt:s-Y,$lt:s+Y})}var o=a.geospatial.read,l=o(e);Q(l,K=X(),Q.drain(t.message_arrived))})}},watch:{position:function(){K.abort(),this.fetch_messages()}},mounted:function(){this.fetch_messages()}},tt=Z,at=(e("49c0"),Object(b["a"])(tt,N,P,!1,null,"2f097b82",null)),et=at.exports,nt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{},[e("h3",{staticClass:"card-title"},[e("span",{staticClass:"font-weight-bold"},[t._v("â¬¡")]),t._v(" "+t._s(t.x)+" / "+t._s(t.y)+" "+t._s(t.status))]),"ScuttleCity"!=t.status?e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],staticClass:"btn-xxs btn-primary"},[t._v("Build a camp ðŸ”¥")]):t._e(),e("b-modal",{attrs:{id:"modal-1",title:"Establish a new Camp"}},[e("p",{staticClass:"my-4"},[t._v("Build a ðŸ”¥")])]),t._l(t.active_tags,function(a){return e("p",[e("span",{staticClass:"badge badge-secondary"},[t._v("\n        "+t._s(a)+"\n      ")])])})],2)},st=[],rt={name:"tile_info",props:["x","y","active_tags"],computed:{status:function(){return this.scuttlecity()?"ScuttleCity":"Unoccupied"}},methods:{scuttlecity:function(){return 4==this.$route.params.x&&21==this.$route.params.y||!this.$route.params.x||!this.$route.params.y}}},it=rt,ot=Object(b["a"])(it,nt,st,!1,null,null,null),lt=ot.exports,ct=e("e018");function ut(t,a,e){var n=t.width,s=t.height,r=a.x,i=a.y,o=e.xExtreme,l=void 0===o?null:o,c=e.yExtreme,u=void 0===c?null:c,d=dt((n-r)/2,l,Math.cos),p=dt((s-i)/2,u,Math.sin);return Math.min(d,p)}function dt(t,a,e){if(!a)return t;var n=t-a.value,s=(a.x-90)/180*Math.PI;return Math.abs(n/e(s))}var pt={size:function(t,a,e,n){var s=a.width,r=a.height,i=e.x,o=e.y,l=n.last,c=Math.min(s-i,r-o)/2-l;t.size([360,c]).separation(function(t,a){return(t.parent===a.parent?1:2)/(0!==t.depth?t.depth:1)})},optimizeSize:function(t,a,e,n){var s=ut(a,e,n||{});t.size([360,s]).separation(function(t,a){return(t.parent===a.parent?1:2)/(0!==t.depth?t.depth:1)})},transformNode:function(t,a){var e=(t-90)/180*Math.PI,n=a;return[~~(n*Math.cos(e)),~~(n*Math.sin(e))]},transformSvg:function(t,a,e){var n=e.width,s=e.height;return t.attr("transform","translate("+n/2+","+s/2+")")},updateTransform:function(t,a,e){var n=e.width,s=e.height;return t.translate(n/2,s/2)},getLine:function(t){return t.radialLine().radius(function(t){return t.y}).angle(function(t){return t.x/180*Math.PI})},transformText:function(t,a){return{x:t.x<180===!a?6:-6,rotate:t.x<180?t.x-90:t.x+90,anchor:t.x<180===!a?"start":"end"}}},mt=e("5698");window.map_context="";e("3e1e"),e("90de");var ft,ht,vt,gt,bt,yt=20;function _t(t){map_context.$router.push({path:"/".concat(t.i,"/").concat(t.j)})}function xt(t,a,e){t.attr("d",a(ct["b"](e,e.objects.hexagons,function(t,a){return t.fill^a.fill})))}function $t(t,a,e){for(var n=2*t*Math.sin(Math.PI/3),s=1.5*t,r=Math.ceil((e+t)/s)+1,i=Math.ceil(a/n)+1,o=[],l=[],c=-1;c<=r;++c)for(var u=-1;u<=i;++u){var d=2*c,p=2*(u+(1&c)/2);l.push([[p,d-1],[1,1]],[[p+1,d],[0,1]],[[p+1,d+1],[-1,1]])}for(var m=map_context.$props.x,f=map_context.$props.y,h=1,v=(c=0,3);c<r;++c,v+=6)for(u=0;u<i;++u,v+=3){var g=u+"/"+c,b=map_context.$data.activity[g];o.push({type:"Polygon",arcs:[[v,v+1,v+2,~(v+3*(i+2-(1&c))),~(v-2),~(v-3*(i+2+(1&c))+2)]],fill:m==u&&f==c,last_activity:b?b.last_activity:null,tags:b&&b.tags?b.tags.map(function(t){return"string"==typeof t?t:null}):[],j:c,i:u,id:h}),h++}return{transform:{translate:[0,0],scale:[1,1]},objects:{hexagons:{type:"GeometryCollection",geometries:o}},arcs:l}}function wt(t){var a=2*t*Math.sin(Math.PI/3),e=1.5*t;return{stream:function(t){return{point:function(n,s){t.point(n*a/2,(s-(2-(1&s))/3)*e/2)},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}}}var St={x:-1540,y:-1270},Ct={x:0,y:0},kt={components:{MapSVG:j,Messages:et,TileInfo:lt},props:{x:{type:String,default:"4"},y:{type:String,default:"21"}},data:function(){return{messages:[],activity:{},active_tags:[]}},computed:{position:function(){return this.$route.params.x,this.$route.params.y}},watch:{position:function(){this.getActivity()}},methods:{handle_new_post:function(){this.$forceUpdate(),this.getActivity()},new_activity:function(t,a){this.$data.activity=a;var e=this.$route.params.x,n=this.$route.params.y;e&&n&&(this.$data.active_tags=a[e+"/"+n]?a[e+"/"+n].tags:[]);var s=this.getSize(),r=($t(yt,s.width,s.height),$t(yt,s.width,s.height)),i=wt(yt);gt=mt.geoPath(i);var o=vt.selectAll("path").data(r.objects.hexagons.geometries),l=ht.selectAll("text").data(r.objects.hexagons.geometries);this.update_backgrounds(o,r),this.update_labels(l,r),this.update_borders(ft,r)},getSize:function(){var t=2270,a=1300;return{width:t,height:a}},transformSvg:function(t,a){return a=a||this.getSize(),pt.transformSvg(t,this.margin,a)},updateTransform:function(t,a){return a=a||this.getSize(),pt.updateTransform(t,this.margin,a)},resize:function(){var t=this.getSize(),a=this.internaldata,e=a.g,n=(a.svg,a.tree);this.transformSvg(e,t),pt.optimizeSize(n,t,this.margin,this.textContraint),this.redraw()},getActivity:function(t){var a=this;console.log("getActivity"),this.$ssb.then(function(t){t.geospatial.get(a.new_activity)})},zoomed:function(){var t=mt.event.transform;t.x=mt.max([t.x,St.x]),t.y=mt.max([t.y,St.y]),t.x=mt.min([t.x,Ct.x]),t.y=mt.min([t.y,Ct.y]),bt.attr("transform",t)},activity_to_alpha:function(t){if(null!=t.last_activity){if(4==t.i&&21==t.j)return 0;var a=Date.now()-t.last_activity,e=6048e4;return Math.min(Math.max(e/a,.05),.35)}},apply_attributes:function(t,a){return t.attr("d",function(t){return gt(ct["a"](a,t))}).attr("fill-opacity",function(t){return map_context.activity_to_alpha(t)}).style("fill",function(t){return null!=t.last_activity?"Green":null}).on("click",_t)},update_backgrounds:function(t,a){this.apply_attributes(t,a),this.apply_attributes(t.enter().append("path"),a).merge(t),t.exit().remove()},update_borders:function(t,a){t.attr("class","border").call(xt,gt,a),t.enter().append("path").attr("class","border").call(xt,gt,a),t.exit().remove()},apply_label_attrs:function(t,a){return t.attr("class","label").text(function(t){return 4==t.i&&21==t.j?void 0:t.tags.join(", ")}).attr("transform",function(t){return"translate("+34.64*t.i+","+(30*t.j-15)+")"})},update_labels:function(t,a){this.apply_label_attrs(t),this.apply_label_attrs(t.enter().append("text")),t.exit().remove()}},mounted:function(){this.$ssb.then(function(t){var a="@+COav7rGgSXqV36bsgYJK1EHtUuk9SvojPFGdIzJLlA=.ed25519",e=JSON.parse(localStorage.keys).id;t.friends.isFollowing({source:e,dest:a},function(e,n){n||m.post_as(t,JSON.parse(localStorage.keys),{type:"contact",contact:a,following:!0},function(){})})});var t={top:-5,right:-5,bottom:-5,left:-5},a=mt.select("#map_svg").append("g").attr("transform","translate("+t.left+","+t.right+")").attr("class","wrapper").data([{x:0,y:0}]);+a.attr("width"),+a.attr("height");var n=this.getSize();i=mt.geoPath(r),map_context=this;var s=$t(yt,n.width,n.height),r=wt(yt),i=mt.geoPath(r);bt=a,mt.select("#map_svg").call(mt.zoom().scaleExtent([.5,3]).on("zoom",this.zoomed));var o=bt.selectAll("image").data([0]);o.enter().append("svg:image").attr("x",0).attr("y",-2).attr("width",2280).attr("height",1300).attr("xlink:href",e("0c20")),vt=bt.append("g").attr("class","hexagon"),bt.append("g").append("path").datum(ct["b"](s,s.objects.hexagons)).attr("class","mesh").attr("d",i),ft=bt.append("g").attr("class","border").append("path").attr("class","border").call(xt,i,s),ht=bt.append("g").attr("class","labels").datum(ct["b"](s,s.objects.hexagons)).attr("class","label"),this.getActivity()},updated:function(){console.log("update")}},Ot=kt,jt=(e("5490"),Object(b["a"])(Ot,k,O,!1,null,null,null)),Nt=jt.exports,Pt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"fb-profile"},[e("div",{staticClass:"fb-image-profile card vue-avatar-cropper-demo text-center"},[e("div",{staticClass:"card-body"},[e("img",{staticClass:"card-img avatar",attrs:{src:t.avatar}}),t._m(0),e("h5",{staticClass:"card-title mb-0"},[t._v(t._s(t.author.authorName))])]),e("div",{staticClass:"card-footer text-muted",domProps:{innerHTML:t._s(t.message)}}),e("avatar-cropper",{attrs:{trigger:"#pick-avatar"},on:{uploading:t.handleUploading,uploaded:t.handleUploaded,completed:t.handleCompleted,error:t.handlerError}})],1),e("form",{on:{submit:function(a){return a.preventDefault(),t.handleSubmit(a)}}},[e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_name,expression:"new_name"}],staticClass:"form-control",attrs:{type:"name",id:"name",placeholder:"Enter name"},domProps:{value:t.new_name},on:{input:function(a){a.target.composing||(t.new_name=a.target.value)}}})]),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Update")])])]),e("div")])},Mt=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"card-img-overlay"},[e("button",{staticClass:"btn btn-primary btn-sm",attrs:{id:"pick-avatar"}},[t._v("Select an new image")])])}],Et=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"avatar-cropper"},[t.dataUrl?e("div",{staticClass:"avatar-cropper-overlay"},[e("div",{staticClass:"avatar-cropper-mark"},[e("a",{staticClass:"avatar-cropper-close",attrs:{href:"javascript:;"},on:{click:t.destroy}},[t._v("Ã—")])]),e("div",{staticClass:"avatar-cropper-container"},[e("div",{staticClass:"avatar-cropper-image-container"},[e("img",{ref:"img",attrs:{src:t.dataUrl,alt:""},on:{load:function(a){return a.stopPropagation(),t.createCropper(a)}}})]),e("div",{staticClass:"avatar-cropper-footer"},[e("button",{staticClass:"avatar-cropper-btn",domProps:{textContent:t._s(t.labels.cancel)},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.destroy(a)}}},[t._v("Cancel")]),e("button",{staticClass:"avatar-cropper-btn",domProps:{textContent:t._s(t.labels.submit)},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.submit(a)}}},[t._v("Submit")])])])]):t._e(),e("input",{ref:"input",staticClass:"avatar-cropper-img-input",attrs:{accept:t.mimes,type:"file"}})])},Jt=[],It=e("7618"),Ut=(e("c5f6"),e("6107"),e("bab4")),zt=e.n(Ut),Tt=e("acb4"),qt={props:{trigger:{type:[String,Element],required:!0},uploadHandler:{type:Function},blobHandler:{type:Function},uploadUrl:{type:String},requestMethod:{type:String,default:"POST"},uploadHeaders:{type:Object},uploadFormName:{type:String,default:"file"},uploadFormData:{type:Object,default:function(){return{}}},cropperOptions:{type:Object,default:function(){return{aspectRatio:1,autoCropArea:1,viewMode:1,movable:!1,zoomable:!1}}},outputOptions:{type:Object},outputMime:{type:String,default:null},outputQuality:{type:Number,default:.9},mimes:{type:String,default:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},labels:{type:Object,default:function(){return{submit:"submit",cancel:"cancel"}}}},data:function(){return{cropper:void 0,dataUrl:void 0,filename:void 0}},methods:{destroy:function(){this.cropper.destroy(),this.$refs.input.value="",this.dataUrl=void 0},submit:function(){this.$emit("submit"),this.uploadImage(),this.destroy()},pickImage:function(t){this.$refs.input.click(),t.preventDefault(),t.stopPropagation()},createCropper:function(){this.cropper=new zt.a(this.$refs.img,this.cropperOptions)},uploadImage:function(){var t=this,a=this.cropper.getCroppedCanvas(this.outputOptions).toDataURL();this.$emit("uploading");var e=Tt.parse(a);this.$ssb.then(function(a){c()(c.a.once(e.data),a.blobs.add(function(n,s){if(n)return alert(n.stack);var r={link:s,size:e.data.length,type:e.mimetype,width:512,height:512};m.post_as(a,JSON.parse(localStorage.keys),{type:"about",about:JSON.parse(localStorage.keys).id,image:r},function(a,e){t.$emit("completed"),t.$emit("uploaded")})}))}),this.outputMime,this.outputQuality}},mounted:function(){var t=this,a="object"==Object(It["a"])(this.trigger)?this.trigger:document.querySelector(this.trigger);a?a.addEventListener("click",this.pickImage):this.$emit("error","No avatar make trigger found.","user");var e=this.$refs.input;e.addEventListener("change",function(){if(null!=e.files&&null!=e.files[0]){var a=new FileReader;a.onload=function(a){t.dataUrl=a.target.result},a.readAsDataURL(e.files[0]),t.filename=e.files[0].name||"unknown",t.mimeType=t.mimeType||e.files[0].type,t.$emit("changed",e.files[0],a)}})}},Dt=qt,At=(e("5f48"),Object(b["a"])(Dt,Et,Jt,!1,null,null,null)),Lt=At.exports;c.a.paraMap=e("a7b3");e("90ce");var Ht={name:"profile",components:{AvatarCropper:Lt},data:function(){return{avatar:"https://via.placeholder.com/90x90",author:"...",new_name:"",new_key:"",key:JSON.parse(localStorage.keys),message:"",user:{id:1}}},methods:{uploadHandler:function(t){},handleUploading:function(t,a){this.message="uploading..."},handleUploaded:function(){var t=this;this.$ssb.then(function(a){m.avatar(a,JSON.parse(localStorage.keys).id,t.avatar_loaded)}),this.message="saved"},handleCompleted:function(t,a,e){this.message="upload completed."},handlerError:function(t,a,e){this.message="Oops! Something went wrong..."+t},name_loaded:function(t,a){if(this.$data.author=a,"https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,JSON.parse(localStorage.keys).id).getImage();this.$data.avatar=e}},avatar_loaded:function(t,a){a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)},handleSubmit:function(){var t=this;console.log("submit"),""!=this.$data.new_name&&this.$data.new_name!=this.$data.author.authorName&&(console.log("valid changes, post to ssb"),this.$ssb.then(function(a){var e={type:"about",about:t.$data.key.id,name:t.$data.new_name};console.log("posting",e),m.post_as(a,JSON.parse(localStorage.keys),e),t.$data.new_name=""}))}},mounted:function(){var t=this;this.$ssb.then(function(a){m.displayName(a,JSON.parse(localStorage.keys).id,t.name_loaded),m.avatar(a,JSON.parse(localStorage.keys).id,t.avatar_loaded)})}},Vt=Ht,Ft=(e("bca8"),Object(b["a"])(Vt,Pt,Mt,!1,null,"95690a3e",null)),Gt=Ft.exports,Rt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"fb-profile"},[e("div",{staticClass:"fb-image-profile card vue-avatar-cropper-demo text-center"},[e("div",{staticClass:"card-body"},[e("img",{staticClass:"card-img avatar",attrs:{src:t.avatar}}),t._m(0),e("h5",{staticClass:"card-title mb-0"},[t._v(t._s(t.author.authorName))])]),e("div",{staticClass:"card-footer text-muted",domProps:{innerHTML:t._s(t.message)}}),e("avatar-cropper",{attrs:{trigger:"#pick-avatar"},on:{uploading:t.handleUploading,uploaded:t.handleUploaded,completed:t.handleCompleted,error:t.handlerError}})],1),e("form",{on:{submit:function(a){return a.preventDefault(),t.handleSubmit(a)}}},[e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_name,expression:"new_name"}],staticClass:"form-control",attrs:{type:"name",id:"name",placeholder:"Enter name"},domProps:{value:t.new_name},on:{input:function(a){a.target.composing||(t.new_name=a.target.value)}}})]),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Update")])])])])},Bt=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"card-img-overlay"},[e("button",{staticClass:"btn btn-primary btn-sm",attrs:{id:"pick-avatar"}},[t._v("Select an new image")])])}];c.a.paraMap=e("a7b3");e("90ce");var Kt={name:"camp",data:function(){return{avatar:"https://via.placeholder.com/90x90",author:"...",new_name:"",new_key:"",key:JSON.parse(localStorage.keys),message:"",user:{id:1}}},methods:{uploadHandler:function(t){},handleUploading:function(t,a){this.message="uploading...",console.log("handle_uploading",t,a)},handleUploaded:function(){var t=this;this.$ssb.then(function(a){m.avatar(a,JSON.parse(localStorage.keys).id,t.avatar_loaded)}),this.message="saved"},handleCompleted:function(t,a,e){this.message="upload completed."},handlerError:function(t,a,e){this.message="Oops! Something went wrong..."+t},name_loaded:function(t,a){if(this.$data.author=a,"https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,JSON.parse(localStorage.keys).id).getImage();this.$data.avatar=e}},avatar_loaded:function(t,a){a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)},handleSubmit:function(){var t=this;console.log("submit"),""!=this.$data.new_name&&this.$data.new_name!=this.$data.author.authorName&&(console.log("valid changes, post to ssb"),this.$ssb.then(function(a){var e={type:"about",about:t.$data.key.id,name:t.$data.new_name};console.log("posting",e),m.post_as(a,JSON.parse(localStorage.keys),e),t.$data.new_name=""}))}},mounted:function(){}},Qt=Kt,Xt=Object(b["a"])(Qt,Rt,Bt,!1,null,"2363792e",null),Yt=Xt.exports,Wt=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"fb-profile"},[e("div",{staticClass:"fb-image-profile card vue-avatar-cropper-demo text-center"},[e("div",{staticClass:"card-body"},[e("img",{staticClass:"card-img avatar",attrs:{src:t.avatar}}),e("div",{staticClass:"card-img-overlay"}),e("h5",{staticClass:"card-title mb-0"},[t._v(t._s(t.author.authorName))])])])]),t._m(0)])},Zt=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("p"),e("h1",{staticClass:"lead"},[t._v("No guilds")]),e("p")])}];c.a.paraMap=e("a7b3");e("90ce");var ta={name:"profile",props:["id"],data:function(){return{avatar:"https://via.placeholder.com/90x90",author:"..."}},methods:{name_loaded:function(t,a){if(this.$data.author=a,"https://via.placeholder.com/90x90"==this.$data.avatar){var e=new h.a(300,this.$props.id).getImage();this.$data.avatar=e}},avatar_loaded:function(t,a){a&&(this.$data.avatar="http://ssb.guild.land/blobs/get/"+a)}},mounted:function(){var t=this;this.$ssb.then(function(a){m.displayName(a,t.$props.id,t.name_loaded),m.avatar(a,t.$props.id,t.avatar_loaded)})}},aa=ta,ea=(e("1574"),Object(b["a"])(aa,Wt,Zt,!1,null,"47c58bcc",null)),na=ea.exports;n["default"].use(C["a"]);var sa=new C["a"]({routes:[{path:"/",name:"Home",component:Nt},{path:"/:x(\\d+)/:y(\\d+)",name:"Map",component:Nt,props:!0},{path:"/:x(\\d+)/:y(\\d+)/camp",name:"New Camp",component:Yt},{path:"/:x(\\d+)/:y(\\d+)/post/:id",name:"View Post",component:et},{path:"/profile",name:"Profile",component:Gt},{path:"/profile/:id",name:"ViewProfile",component:na,props:!0}]}),ra=e("8682"),ia=e("f684"),oa=e("5f5b"),la=(e("f9e3"),e("2dd8"),e("0665")),ca=e.n(la),ua=e("fd37");n["default"].use(ra["a"],{locales:{en:e("52cf")}}),n["default"].use(ia["a"]),n["default"].use(oa["a"]),n["default"].use(ca.a),n["default"].use(ua["a"],{keys:localStorage.keys,remote:"wss://ssb.guild.land/~shs:+COav7rGgSXqV36bsgYJK1EHtUuk9SvojPFGdIzJLlA=",manifest:{geospatial:{read:"source",stream:"source",get:"async"}}}),n["default"].config.productionTip=!1,new n["default"]({router:sa,template:"<app/>",components:{app:S}}).$mount("#app")},"5f48":function(t,a,e){"use strict";var n=e("7b95"),s=e.n(n);s.a},6:function(t,a){},"64a9":function(t,a,e){},7:function(t,a){},"7b95":function(t,a,e){},8:function(t,a){},9:function(t,a){},acec:function(t,a,e){},bca8:function(t,a,e){"use strict";var n=e("d09a"),s=e.n(n);s.a},bdf3:function(t,a,e){},cb87:function(t,a,e){},d09a:function(t,a,e){}});
//# sourceMappingURL=app.435e1c19.js.map